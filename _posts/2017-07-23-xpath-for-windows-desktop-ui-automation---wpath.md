---
title: Windows UI自动化的XPATH实现 - WPATH
categories: [tech]
tags: [Windows UIAutomation,XPATH,WPATH]
date: 2017-07-23
---

从事Windows 桌面应用自动化测试也有一些年了，现在谈这个话题并不流行。因为除了企业级应用，很少有公司会只选择Windows桌面作为目标用户平台，一般都会选择跨平台的浏览器方案，桌面应用的地位不高，更不要谈Windows 桌面了。

时代变化非常之快，当年初入测试行业时就被外包公司选择上了，在微软的圈子里一待就是4年。不得不说，一个大学刚毕业的毛头小子看到微软里各种技术和工具真像极了刘姥姥进大观园，那时候还没有iPhone，也没有Android，微软一统天下。

本文主要介绍一下我对Windows UI自动化的一些看法以及WPATH的实现和应用，如果你还在从事Windows桌面应用的自动化测试，应该能有一些帮助。

## Windows UI 自动化的实现方案

Windows UI 自动化，顾名思义就是在Windows平台实现软件的界面自动化，比如自动打开Excel填入一些数据，输入公式，获取结果。正经的用途就是软件自动化测试，避免重复的手工操作；不正经的用途就是写外挂，各种投机取巧的工具等等。

最简单粗暴的实现方案就是录制回放，主要的代表就是QTP，来自HP公司。这应该是很多同行业的同学都听过的一块测试工具，算是比较好的录制回放，而且还支持编程功能，对录制好的界面元素进行一定的逻辑整合，达到更灵活的回放。

QTP属于比较上层的自动化工具，底层其实依赖的其实还是Windows本身对界面自动化操作的支持，也就是本文的主角：Windows UIAutomation。